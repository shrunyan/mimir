"use strict"

import noteRoute from 'routers/note.js'

let livereload = require('livereload2');
let http = require('http');
let express = require('express');
let mongoose = require('mongoose');
let bodyParser = require('body-parser');
let app = express();

app.set('port', process.env.PORT || 3000);
app.set('views', __dirname + '/views');

app.engine('html', require('ejs').renderFile);


// Middleware
app.use(bodyParser.json({
	limit: '10mb'
}));
app.use(bodyParser.urlencoded({
	limit: '10mb',
	extended: true
}));
app.use('/', express.static(__dirname + '/../../../dist'));


// Database
if ('development' == app.get('env')) {
  livereload.createServer().watch(__dirname + '/../../../dist');
}
else if ('production' == app.get('env')) {

}


//  Routes
app.get('/', function index(req, res) {
	console.log('Route: index');
	res.render('index.html');
});

app.get('/note/*', function index(req, res) {
	console.log('Route: /note/');
	route.note(req, res);
});

app.get('/notes*', function index(req, res) {
	console.log('Route: /notes/');
	route.notes(req, res);
});


// Server
http.createServer(app).listen(app.get('port'), function() {
    console.log('Server up: http://localhost:' + app.get('port'));
});
